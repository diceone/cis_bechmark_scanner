- id: "1.1.1.1"
  description: "Ensure mounting of cramfs filesystems is disabled"
  command: "modprobe -n -v cramfs"
  expected: "install /bin/true"

- id: "1.1.1.2"
  description: "Ensure mounting of squashfs filesystems is disabled"
  command: "modprobe -n -v squashfs"
  expected: "install /bin/true"

- id: "1.1.1.3"
  description: "Ensure mounting of udf filesystems is disabled"
  command: "modprobe -n -v udf"
  expected: "install /bin/true"

- id: "1.3.1"
  description: "Ensure AIDE is installed"
  command: "rpm -q aide"
  expected: "aide"

- id: "1.4.1"
  description: "Ensure bootloader password is set"
  command: "grep '^GRUB2_PASSWORD' /boot/grub2/user.cfg"
  expected: "GRUB2_PASSWORD"

- id: "2.1.1"
  description: "Ensure xinetd is not installed"
  command: "rpm -q xinetd"
  expected: "package xinetd is not installed"

- id: "2.2.1.1"
  description: "Ensure time synchronization is in use"
  command: "rpm -q chrony || rpm -q ntp"
  expected: "chrony"

- id: "3.1.1"
  description: "Ensure IP forwarding is disabled"
  command: "sysctl net.ipv4.ip_forward"
  expected: "net.ipv4.ip_forward = 0"

- id: "3.2.1"
  description: "Ensure packet redirect sending is disabled"
  command: "sysctl net.ipv4.conf.all.send_redirects"
  expected: "net.ipv4.conf.all.send_redirects = 0"

- id: "4.1.1.1"
  description: "Ensure auditd is installed"
  command: "rpm -q audit"
  expected: "audit"

- id: "5.1.1"
  description: "Ensure cron daemon is enabled"
  command: "systemctl is-enabled crond"
  expected: "enabled"

- id: "5.2.1"
  description: "Ensure permissions on /etc/ssh/sshd_config are configured"
  command: "stat -L -c '%a %u %g' /etc/ssh/sshd_config"
  expected: "600 0 0"

- id: "6.1.2"
  description: "Ensure permissions on /etc/passwd are configured"
  command: "stat -L -c '%a %u %g' /etc/passwd"
  expected: "644 0 0"

- id: "6.1.3"
  description: "Ensure permissions on /etc/shadow are configured"
  command: "stat -L -c '%a %u %g' /etc/shadow"
  expected: "000 0 0"

- id: "7.1.1"
  description: "Ensure password expiration is 365 days or less"
  command: "grep PASS_MAX_DAYS /etc/login.defs"
  expected: "PASS_MAX_DAYS 365"

- id: "7.1.2"
  description: "Ensure minimum days between password changes is configured"
  command: "grep PASS_MIN_DAYS /etc/login.defs"
  expected: "PASS_MIN_DAYS 7"

- id: "7.2.1"
  description: "Ensure password hashing algorithm is SHA-512"
  command: "authconfig --test | grep hashing"
  expected: "password hashing algorithm is sha512"

- id: "8.1.1"
  description: "Ensure message of the day is configured properly"
  command: "grep -E -i '(\\\\v|\\\\r|\\\\m|\\\\s|$(grep \"\\w\" /etc/issue))' /etc/motd"
  expected: ""

- id: "8.2.1"
  description: "Ensure GDM login banner is configured"
  command: "grep banner-message-enable /etc/gdm/greeter.dconf-defaults"
  expected: "banner-message-enable=true"

- id: "9.1.1"
  description: "Ensure firewalld is installed"
  command: "rpm -q firewalld"
  expected: "firewalld"

- id: "9.1.2"
  description: "Ensure iptables-services not installed"
  command: "rpm -q iptables-services"
  expected: "package iptables-services is not installed"

- id: "9.2.1"
  description: "Ensure SELinux is installed"
  command: "rpm -q libselinux"
  expected: "libselinux"

- id: "9.2.2"
  description: "Ensure SELinux is not disabled in bootloader configuration"
  command: "grep -E 'selinux=0|enforcing=0' /etc/default/grub"
  expected: ""

- id: "10.1.1"
  description: "Ensure system-wide crypto policy is not legacy"
  command: "update-crypto-policies --show"
  expected: "DEFAULT"

- id: "10.2.1"
  description: "Ensure rsyslog is installed"
  command: "rpm -q rsyslog"
  expected: "rsyslog"

- id: "10.2.2"
  description: "Ensure rsyslog Service is enabled"
  command: "systemctl is-enabled rsyslog"
  expected: "enabled"

- id: "11.1.1"
  description: "Ensure no world writable files exist"
  command: "df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}' -xdev -type f -perm -0002 -ls"
  expected: ""

- id: "11.2.1"
  description: "Ensure no unowned files or directories exist"
  command: "df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}' -xdev -nouser -ls"
  expected: ""

- id: "12.1.1"
  description: "Verify Permissions on /etc/passwd-"
  command: "stat -L -c '%a %u %g' /etc/passwd-"
  expected: "600 0 0"

- id: "12.2.1"
  description: "Ensure password fields are not empty"
  command: "awk -F: '($2 == \"\" ) { print $1 \" does not have a password \"}' /etc/shadow"
  expected: ""

- id: "13.1.1"
  description: "Ensure sudo is installed"
  command: "rpm -q sudo"
  expected: "sudo"

- id: "13.2.1"
  description: "Ensure sudo commands use pty"
  command: "grep -Ei '^Defaults.*use_pty' /etc/sudoers"
  expected: "Defaults use_pty"
