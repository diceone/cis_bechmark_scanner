- id: "1.1.1.1"
  description: "Ensure mounting of cramfs filesystems is disabled"
  command: "modprobe -n -v cramfs"
  expected: "install /bin/true"

- id: "1.1.1.2"
  description: "Ensure mounting of freevxfs filesystems is disabled"
  command: "modprobe -n -v freevxfs"
  expected: "install /bin/true"

- id: "1.1.1.3"
  description: "Ensure mounting of jffs2 filesystems is disabled"
  command: "modprobe -n -v jffs2"
  expected: "install /bin/true"

- id: "1.3.1"
  description: "Ensure AIDE is installed"
  command: "dpkg -s aide"
  expected: "Status: install ok installed"

- id: "1.3.2"
  description: "Ensure filesystem integrity is regularly checked"
  command: "systemctl is-enabled aidecheck.service aidecheck.timer"
  expected: "enabled"

- id: "1.4.1"
  description: "Ensure bootloader password is set"
  command: "grep \"^set superusers\" /boot/grub/grub.cfg"
  expected: "set superusers"

- id: "1.5.1"
  description: "Ensure AppArmor is installed"
  command: "dpkg -s apparmor"
  expected: "Status: install ok installed"

- id: "1.5.2"
  description: "Ensure AppArmor is enabled in the bootloader configuration"
  command: "grep \"^GRUB_CMDLINE_LINUX=\" /etc/default/grub"
  expected: "apparmor=1"

- id: "2.1.1"
  description: "Ensure xinetd is not installed"
  command: "dpkg -s xinetd"
  expected: "package 'xinetd' is not installed"

- id: "2.2.1"
  description: "Ensure time synchronization is in use"
  command: "dpkg -s chrony ntp | grep -E '^Status: .+ installed'"
  expected: "Status: install ok installed"

- id: "3.1.1"
  description: "Ensure packet redirect sending is disabled"
  command: "sysctl net.ipv4.conf.all.send_redirects"
  expected: "net.ipv4.conf.all.send_redirects = 0"

- id: "3.2.1"
  description: "Ensure IP forwarding is disabled"
  command: "sysctl net.ipv4.ip_forward"
  expected: "net.ipv4.ip_forward = 0"

- id: "3.3.1"
  description: "Ensure UFW is installed"
  command: "dpkg -s ufw"
  expected: "Status: install ok installed"

- id: "3.3.2"
  description: "Ensure UFW service is enabled"
  command: "systemctl is-enabled ufw"
  expected: "enabled"

- id: "4.1.1"
  description: "Ensure auditd is installed"
  command: "dpkg -s auditd"
  expected: "Status: install ok installed"

- id: "4.1.2"
  description: "Ensure auditd service is enabled"
  command: "systemctl is-enabled auditd"
  expected: "enabled"

- id: "5.1.1"
  description: "Ensure cron daemon is enabled"
  command: "systemctl is-enabled cron"
  expected: "enabled"

- id: "5.2.1"
  description: "Ensure permissions on /etc/ssh/sshd_config are configured"
  command: "stat -L -c '%a %u %g' /etc/ssh/sshd_config"
  expected: "600 0 0"

- id: "5.2.2"
  description: "Ensure SSH Protocol 2 is enabled"
  command: "grep '^Protocol' /etc/ssh/sshd_config"
  expected: "Protocol 2"

- id: "6.1.1"
  description: "Ensure permissions on /etc/passwd are configured"
  command: "stat -L -c '%a %u %g' /etc/passwd"
  expected: "644 0 0"

- id: "6.1.2"
  description: "Ensure permissions on /etc/shadow are configured"
  command: "stat -L -c '%a %u %g' /etc/shadow"
  expected: "640 0 42"

- id: "6.2.1"
  description: "Ensure password fields are not empty"
  command: "awk -F: '($2 == \"\" ) { print $1 \" does not have a password \"}' /etc/shadow"
  expected: ""

- id: "7.1.1"
  description: "Ensure password expiration is 365 days or less"
  command: "grep PASS_MAX_DAYS /etc/login.defs"
  expected: "PASS_MAX_DAYS 365"

- id: "7.1.2"
  description: "Ensure minimum days between password changes is 7 or more"
  command: "grep PASS_MIN_DAYS /etc/login.defs"
  expected: "PASS_MIN_DAYS 7"

- id: "7.2.1"
  description: "Ensure password hashing algorithm is SHA-512"
  command: "grep -E '^ENCRYPT_METHOD' /etc/login.defs"
  expected: "ENCRYPT_METHOD SHA512"

- id: "8.1.1"
  description: "Ensure message of the day is configured properly"
  command: "grep -E -i '(\\\\v|\\\\r|\\\\m|\\\\s|$(grep \"\\w\" /etc/issue))' /etc/motd"
  expected: ""

- id: "9.1.1"
  description: "Ensure sudo is installed"
  command: "dpkg -s sudo"
  expected: "Status: install ok installed"

- id: "9.1.2"
  description: "Ensure sudo commands use pty"
  command: "grep -Ei '^Defaults.*use_pty' /etc/sudoers"
  expected: "Defaults use_pty"

- id: "10.1.1"
  description: "Ensure system-wide crypto policy is not legacy"
  command: "grep -E '^CRYPTO_POLICY=' /etc/crypto-policies/config"
  expected: "CRYPTO_POLICY=DEFAULT"

- id: "10.2.1"
  description: "Ensure rsyslog is installed"
  command: "dpkg -s rsyslog"
  expected: "Status: install ok installed"

- id: "10.2.2"
  description: "Ensure rsyslog Service is enabled"
  command: "systemctl is-enabled rsyslog"
  expected: "enabled"

- id: "11.1.1"
  description: "Ensure no world writable files exist"
  command: "df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}' -xdev -type f -perm -0002 -ls"
  expected: ""

- id: "11.2.1"
  description: "Ensure no unowned files or directories exist"
  command: "df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}' -xdev -nouser -ls"
  expected: ""

- id: "12.1.1"
  description: "Ensure CUPS is not installed unless needed"
  command: "dpkg -s cups"
  expected: "package 'cups' is not installed"

- id: "12.1.2"
  description: "Ensure IMAP and POP3 server is not installed unless needed"
  command: "dpkg -s dovecot-imapd dovecot-pop3d"
  expected: "package 'dovecot-imapd' is not installed"

- id: "12.1.3"
  description: "Ensure Samba is not installed unless needed"
  command: "dpkg -s samba"
  expected: "package 'samba' is not installed"

- id: "12.2.1"
  description: "Ensure X Window System is not installed"
  command: "dpkg -l xserver-xorg*"
  expected: "no packages found matching xserver-xorg"

- id: "13.1.1"
  description: "Ensure systemd-timesyncd is configured"
  command: "systemctl is-enabled systemd-timesyncd.service"
  expected: "enabled"

- id: "13.1.2"
  description: "Ensure systemd-timesyncd is synchronized"
  command: "timedatectl status | grep 'System clock synchronized'"
  expected: "System clock synchronized: yes"

- id: "13.2.1"
  description: "Ensure automatic error reporting is disabled"
  command: "dpkg -s apport"
  expected: "package 'apport' is not installed"

- id: "13.2.2"
  description: "Ensure core dumps are restricted"
  command: "grep -E '^\\*\\s+hard\\s+core\\s+0$' /etc/security/limits.conf"
  expected: "* hard core 0"

- id: "14.1.1"
  description: "Ensure AIDE is configured to use SHA512 checksums"
  command: "grep '^Checksums' /etc/aide/aide.conf"
  expected: "sha512"

- id: "14.1.2"
  description: "Ensure successful file system mounts are collected"
  command: "auditctl -l | grep mounts"
  expected: "-a always,exit -F arch=b64 -S mount -F auid>=1000 -F auid!=-1 -k mounts"

- id: "14.2.1"
  description: "Ensure AppArmor profiles are enforcing"
  command: "aa-status | grep 'profiles are in enforce mode'"
  expected: "profiles are in enforce mode"

- id: "14.2.2"
  description: "Ensure all AppArmor Profiles are enforcing"
  command: "aa-status | grep -c 'profiles are in complain mode'"
  expected: "0"

- id: "15.1.1"
  description: "Ensure at/cron is restricted to authorized users"
  command: "stat -L -c '%a %u %g' /etc/cron.allow"
  expected: "640 0 0"

- id: "15.1.2"
  description: "Ensure permissions on /etc/crontab are configured"
  command: "stat -L -c '%a %u %g' /etc/crontab"
  expected: "600 0 0"

- id: "15.2.1"
  description: "Ensure SSH AllowTcpForwarding is disabled"
  command: "grep '^AllowTcpForwarding' /etc/ssh/sshd_config"
  expected: "AllowTcpForwarding no"

- id: "15.2.2"
  description: "Ensure SSH MaxAuthTries is set to 4 or less"
  command: "grep '^MaxAuthTries' /etc/ssh/sshd_config"
  expected: "MaxAuthTries 4"

- id: "15.2.3"
  description: "Ensure SSH MaxStartups is configured"
  command: "grep '^MaxStartups' /etc/ssh/sshd_config"
  expected: "MaxStartups 10:30:60"

- id: "16.1.1"
  description: "Ensure system accounts are secured"
  command: "awk -F: '$3 < 1000 && $7 != \"/sbin/nologin\" && $7 != \"/bin/false\" && $1 != \"root\"' /etc/passwd"
  expected: ""

- id: "16.1.2"
  description: "Ensure default group for the root account is GID 0"
  command: "grep '^root:' /etc/passwd | cut -d: -f4"
  expected: "0"

- id: "16.2.1"
  description: "Ensure password expiration warning days is 7 or more"
  command: "grep PASS_WARN_AGE /etc/login.defs"
  expected: "PASS_WARN_AGE 7"

- id: "16.2.2"
  description: "Ensure inactive password lock is 30 days or less"
  command: "useradd -D | grep INACTIVE"
  expected: "INACTIVE=30"

- id: "17.1.1"
  description: "Ensure nodev option set on /tmp partition"
  command: "mount | grep ' /tmp ' | grep nodev"
  expected: "nodev"

- id: "17.1.2"
  description: "Ensure nosuid option set on /tmp partition"
  command: "mount | grep ' /tmp ' | grep nosuid"
  expected: "nosuid"

- id: "17.2.1"
  description: "Ensure noexec option set on /var/tmp partition"
  command: "mount | grep ' /var/tmp ' | grep noexec"
  expected: "noexec"

- id: "18.1.1"
  description: "Ensure sticky bit is set on all world-writable directories"
  command: "df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}' -xdev -type d -perm -0002 ! -perm -1000 -ls"
  expected: ""

- id: "18.1.2"
  description: "Ensure permissions on /etc/issue are configured"
  command: "stat -L -c '%a %u %g' /etc/issue"
  expected: "644 0 0"

- id: "18.2.1"
  description: "Ensure rsh client is not installed"
  command: "dpkg -s rsh-client"
  expected: "package 'rsh-client' is not installed"

- id: "18.2.2"
  description: "Ensure talk client is not installed"
  command: "dpkg -s talk"
  expected: "package 'talk' is not installed"

- id: "18.2.3"
  description: "Ensure telnet client is not installed"
  command: "dpkg -s telnet"
  expected: "package 'telnet' is not installed"

- id: "19.1.1"
  description: "Ensure snap is installed"
  command: "dpkg -s snapd"
  expected: "Status: install ok installed"

- id: "19.1.2"
  description: "Ensure snapd service is enabled"
  command: "systemctl is-enabled snapd.service"
  expected: "enabled"

- id: "19.1.3"
  description: "Ensure snap store is configured securely"
  command: "snap get system store-certs"
  expected: "store-certs"

- id: "19.2.1"
  description: "Ensure AppArmor profiles are enforcing"
  command: "aa-status --enforced"
  expected: "apparmor module is loaded"

- id: "19.2.2"
  description: "Ensure no AppArmor profiles are in complain mode"
  command: "aa-status --complaining"
  expected: "0"

- id: "19.2.3"
  description: "Ensure AppArmor tools are installed"
  command: "dpkg -s apparmor-utils"
  expected: "Status: install ok installed"

- id: "19.3.1"
  description: "Ensure UFW is installed"
  command: "dpkg -s ufw"
  expected: "Status: install ok installed"

- id: "19.3.2"
  description: "Ensure UFW service is enabled"
  command: "systemctl is-enabled ufw"
  expected: "enabled"

- id: "19.3.3"
  description: "Ensure UFW loopback traffic is configured"
  command: "ufw show raw | grep -E 'lo'"
  expected: "ACCEPT"

- id: "19.4.1"
  description: "Ensure systemd-timesyncd is configured"
  command: "systemctl is-enabled systemd-timesyncd"
  expected: "enabled"

- id: "19.4.2"
  description: "Ensure systemd-resolved is configured"
  command: "systemctl is-enabled systemd-resolved"
  expected: "enabled"

- id: "19.5.1"
  description: "Ensure Uncomplicated Firewall is configured"
  command: "ufw status verbose | grep Status"
  expected: "Status: active"

- id: "19.5.2"
  description: "Ensure default deny firewall policy"
  command: "ufw status verbose | grep Default"
  expected: "deny (incoming), allow (outgoing), deny (routed)"

- id: "19.6.1"
  description: "Ensure CUPS is not installed unless needed"
  command: "dpkg -s cups"
  expected: "package 'cups' is not installed"

- id: "19.6.2"
  description: "Ensure IMAP and POP3 server is not installed"
  command: "dpkg -s dovecot-imapd dovecot-pop3d"
  expected: "package 'dovecot-imapd' is not installed"

- id: "19.7.1"
  description: "Ensure GDM is removed if not required"
  command: "dpkg -s gdm3"
  expected: "package 'gdm3' is not installed"

- id: "19.7.2"
  description: "Ensure Xorg Server components are not installed"
  command: "dpkg -s xserver-xorg*"
  expected: "package 'xserver-xorg' is not installed"

- id: "19.8.1"
  description: "Ensure motd is configured properly"
  command: "stat -L -c \"%a %u %g\" /etc/motd"
  expected: "644 0 0"

- id: "19.9.1"
  description: "Ensure GNOME Display Manager is configured"
  command: "grep -Eis '^\s*Enable\s*=\s*true' /etc/gdm3/custom.conf"
  expected: "Enable=true"

- id: "19.10.1"
  description: "Ensure separate partition exists for /var"
  command: "findmnt /var"
  expected: "/var"

- id: "19.10.2"
  description: "Ensure separate partition exists for /var/tmp"
  command: "findmnt /var/tmp"
  expected: "/var/tmp"

- id: "19.11.1"
  description: "Ensure nodev option set on removable media partitions"
  command: "grep -E '\\s/media\\s' /etc/fstab | grep -v nodev"
  expected: ""

- id: "19.12.1"
  description: "Ensure message of the day is configured properly"
  command: "grep -E -i '(\\v|\\r|\\m|\\s|$(grep '\''\\v'\'' /etc/motd))' /etc/motd"
  expected: ""

- id: "20.1.1"
  description: "Ensure system-wide crypto policy is not legacy"
  command: "update-crypto-policies --show"
  expected: "DEFAULT"

- id: "20.1.2"
  description: "Ensure no legacy SSL/TLS versions are used"
  command: "grep -r 'LEGACY' /etc/ssl/openssl.cnf"
  expected: ""

- id: "20.2.1"
  description: "Ensure password hashing algorithm is SHA-512"
  command: "grep -E '^password\\s+\\S+\\s+pam_unix.so' /etc/pam.d/common-password | grep -v sha512"
  expected: ""

- id: "20.3.1"
  description: "Ensure AIDE uses SHA512 for hashing"
  command: "grep '^Checksums' /etc/aide/aide.conf | grep 'sha512'"
  expected: "sha512"
